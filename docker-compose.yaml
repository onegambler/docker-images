version: '3'
services:
  samba:
    container_name: samba
    image: dastrasmue/rpi-samba:latest
    restart: unless-stopped
    # network_mode: "host"
    ports:
      - "137:137/tcp"
      - "137:137/udp"
      - "138:138/tcp"
      - "138:138/udp"
      - "139:139"
      - "445:445"
      - "445:445/udp"
    volumes:
      - /mnt/extHD/:/share/
    command: 
      -u "roberto:${ROBERTO_PASSWORD}"
      -u "jenny:${JENNY_PASSWORD}"
      -s "NAS:/share/:rw:roberto,jenny"
      
  deluge:
    container_name: "deluge"
    build:
      context: ./deluge
      args:
        - DELUGE_VERSION=1.3.15
        - PUID=1000
        - PGID=1000
    restart: unless-stopped
    environment:
      - TZ=Europe/London # timezone
    ports:
      - "58846:58846"
      - "8112:8112"
    volumes:
      - /mnt/extHD/raspberrypi/configs/deluge/config:/volumes/config
      - /mnt/extHD/raspberrypi/configs/deluge/torrents:/volumes/data
      - /mnt/extHD/download/complete:/volumes/complete
      - /mnt/extHD/download/incomplete/torrent:/volumes/download

  mldonkey:
    container_name: "mldonkey"
    build:
      context: ./mldonkey
    restart: unless-stopped
    environment:
      - TZ=Europe/London # timezone
      - MLDONKEY_CLIENT_NAME=raspberrypi
      - MLDONKEY_ADMIN_PASSWORD=${MLDONKEY_ADMIN_PASSWORD}
      - PUID=1000
      - PGID=1000
    ports:
      - "4000:4000"
      - "4080:4080"
      - "20562:20562"
      - "20566:20566/udp"
      - "16965:16965/udp"
      - "3617:3617/udp"
      - "6881:6881"
      - "6882:6882"
    volumes:
      - /mnt/extHD/raspberrypi/configs/mldonkey:/var/lib/mldonkey
      - /mnt/extHD/download/complete:/download/complete
      - /mnt/extHD/download/incomplete/torrent:/download/incomplete

  jackett:
    container_name: jackett
    image: lsioarmhf/jackett
    # build: ./jackett
    restart: unless-stopped
    environment:
      - PUID=1000 # default user id, for downloaded files access rights
      - PGID=1000 # default group id, for downloaded files access rights
      - TZ=Europe/London # timezone
    ports:
      - "9117:9117"
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /mnt/extHD/download/complete:/download
      - /mnt/extHD/raspberrypi/configs/jackett:/config # config files

  sonarr:
    container_name: sonarr
    image: lsioarmhf/sonarr
    # build: ./sonarr
    restart: unless-stopped
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    ports:
      - "8989:8989"
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /mnt/extHD/raspberrypi/configs/sonarr:/config
      - /mnt/extHD/Roberto/media/series:/tv
      - /mnt/extHD/download/complete:/downloads
    depends_on:
      - jackett
      - deluge

  radarr:
    container_name: radarr
    image: lsioarmhf/radarr
    # build: ./radarr
    restart: unless-stopped
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    ports:
      - "7878:7878"
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /mnt/extHD/raspberrypi/configs/radarr:/config
      - /mnt/extHD/Roberto/media/movies:/movies
      - /mnt/extHD/download/complete:/downloads
    depends_on:
      - jackett
      - deluge
    
  portainer:
    image: portainer/portainer:arm
    container_name: portainer
    restart: unless-stopped
    ports:
      - "9000:9000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /mnt/extHD/raspberrypi/configs/portainer:/data

  organizr:
    image: lsioarmhf/organizr:latest
    container_name: organizr
    volumes:
      - /mnt/extHD/raspberrypi/configs/organizr:/config
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    ports:
      - "80:80"
    depends_on:
        - sonarr
        - radarr
        - deluge

  watchtower:
    image: v2tec/watchtower:armhf-latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /mnt/extHD/raspberrypi/configs/watchtower/config.json:/config.json